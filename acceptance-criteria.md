# 🎯 Issue-Make 验收标准文档

## 验收概述

本文档为Issue-Make项目的验收标准，每个功能需求对应具体的验收点和测试方法。

## 📋 功能需求验收矩阵

### 1. 配置管理功能

#### 需求1.1: 全局配置初始化
**验收点 AC-1.1.1**: 执行`issue-make init`成功创建配置目录
- **测试方法**: 运行命令，检查`~/.issue-make/settings.json`是否创建
- **预期结果**: 配置文件存在且包含默认模板
- **验收标准**: ✅ 文件创建成功 ✅ JSON格式有效

**验收点 AC-1.1.2**: 配置文件包含必要字段
- **测试方法**: 检查配置文件内容
- **预期结果**: 包含url、api、model三个字段
- **验收标准**: ✅ 字段完整 ✅ 值为空字符串或默认值

#### 需求1.2: AI配置验证
**验收点 AC-1.2.1**: 有效配置通过验证
- **测试方法**: 设置有效Deepseek配置并验证
- **预期结果**: 验证通过，无错误提示
- **验收标准**: ✅ 连接测试成功 ✅ API响应正常

**验收点 AC-1.2.2**: 无效配置给出明确提示
- **测试方法**: 设置错误URL或无效API Key
- **预期结果**: 显示具体错误信息
- **验收标准**: ✅ 错误信息清晰 ✅ 指导用户修正

### 2. TUI交互功能

#### 需求2.1: TUI启动与界面
**验收点 AC-2.1.1**: `issue-make`命令成功启动TUI
- **测试方法**: 在项目目录执行命令
- **预期结果**: 全屏TUI界面正常显示
- **验收标准**: ✅ 界面无闪烁 ✅ 响应键盘输入

**验收点 AC-2.1.2**: TUI界面元素完整
- **测试方法**: 检查界面显示内容
- **预期结果**: 显示命令提示、帮助信息
- **验收标准**: ✅ 布局合理 ✅ 信息清晰

#### 需求2.2: Slash命令处理
**验收点 AC-2.2.1**: `/add:feat`命令正确解析
- **测试方法**: 输入slash命令并提交
- **预期结果**: 解析type为feat，进入内容输入模式
- **验收标准**: ✅ 解析正确 ✅ 界面切换流畅

**验收点 AC-2.2.2**: 无效命令给出错误提示
- **测试方法**: 输入错误格式的slash命令
- **预期结果**: 显示正确用法提示
- **验收标准**: ✅ 错误提示友好 ✅ 不退出TUI

**验收点 AC-2.2.3**: slash命令创建文件存放在stash目录
- **测试方法**: 通过TUI slash命令创建issue，检查文件位置
- **预期结果**: 文件创建在`.issues/stash/`目录
- **验收标准**: ✅ 文件路径正确 ✅ 不创建在其他目录

#### 需求2.3: AI标题生成集成
**验收点 AC-2.3.1**: 配置有效时生成标题
- **测试方法**: 输入描述内容，提交生成
- **预期结果**: 生成合理的issue标题
- **验收标准**: ✅ 标题相关 ✅ 长度适中

**验收点 AC-2.3.2**: AI不可用时降级处理
- **测试方法**: 禁用网络或错误配置
- **预期结果**: 使用时间戳作为默认标题
- **验收标准**: ✅ 不中断流程 ✅ 有明确提示

### 3. CLI命令功能

#### 需求3.1: add命令
**验收点 AC-3.1.1**: `issue-make add --type feat path/to/file.md`成功执行
- **测试方法**: 准备描述文件，执行命令
- **预期结果**: 在`.issues/stash/`创建对应文件
- **验收标准**: ✅ 文件创建 ✅ 内容正确 ✅ ID自增

**验收点 AC-3.1.2**: 文件内容格式正确
- **测试方法**: 检查生成的markdown文件
- **预期结果**: 包含frontmatter和原文内容
- **验收标准**: ✅ YAML格式有效 ✅ 字段完整

#### 需求3.2: open命令
**验收点 AC-3.2.1**: 通过number打开issue
- **测试方法**: `issue-make open 0`
- **预期结果**: 对应文件移动到doing目录
- **验收标准**: ✅ 文件移动成功 ✅ AGENTS.md更新

**验收点 AC-3.2.2**: 通过title打开issue
- **测试方法**: `issue-make open "partial-title"`
- **预期结果**: 匹配的文件移动到doing目录
- **验收标准**: ✅ 模糊匹配成功 ✅ 优先级正确

#### 需求3.3: close命令
**验收点 AC-3.3.1**: 正常关闭issue流程
- **测试方法**: 创建solution.md后执行close
- **预期结果**: 文件归档到achieved，清理AGENTS.md
- **验收标准**: ✅ 文件合并 ✅ 临时文件删除 ✅ AGENTS.md清理

### 4. 文件管理功能

#### 需求4.1: 目录结构管理
**验收点 AC-4.1.1**: 自动创建必要目录
- **测试方法**: 首次运行add命令
- **预期结果**: `.issues/`及其子目录创建
- **验收标准**: ✅ 目录结构完整 ✅ 权限正确

#### 需求4.2: ID自增管理
**验收点 AC-4.2.1**: ID从0开始正确递增
- **测试方法**: 连续创建多个issue
- **预期结果**: ID为0,1,2...连续递增
- **验收标准**: ✅ 无重复 ✅ 无跳号

**验收点 AC-4.2.2**: 删除后ID继续递增
- **测试方法**: 删除中间某个issue后创建新issue
- **预期结果**: 新ID为当前最大ID+1
- **验收标准**: ✅ ID唯一性保证

#### 需求4.3: 文件命名规范
**验收点 AC-4.3.1**: stash目录文件命名
- **测试方法**: 创建issue并检查文件名
- **预期结果**: 格式为`{sanitized-title}.{id}.md`
- **验收标准**: ✅ 标题清理 ✅ ID附加 ✅ 扩展名正确

**验收点 AC-4.3.2**: achieved目录文件命名
- **测试方法**: 完成issue并检查归档文件
- **预期结果**: 格式为`{sanitized-title}.md`
- **验收标准**: ✅ ID移除 ✅ 标题保持

**验收点 AC-4.3.3**: issue文件日期格式正确
- **测试方法**: 创建issue并检查frontmatter中的日期
- **预期结果**: 日期格式为`YYYY-MM-DD`
- **验收标准**: ✅ 格式正确 ✅ 无错误日期

### 5. Agent集成功能

#### 需求5.1: AGENTS.md更新
**验收点 AC-5.1.1**: open时正确更新AGENTS.md
- **测试方法**: 执行open命令，检查AGENTS.md
- **预期结果**: 添加任务描述和解决方案模板
- **验收标准**: ✅ 内容插入正确 ✅ 标记符完整

**验收点 AC-5.1.2**: AGENTS.md不存在时自动创建
- **测试方法**: 在无AGENTS.md的项目执行open
- **预期结果**: 创建包含标准模板的文件
- **验收标准**: ✅ 文件创建 ✅ 模板正确

**验收点 AC-5.1.3**: open时创建solution.md文件
- **测试方法**: 执行open命令，检查`.issues/solution.md`是否创建
- **预期结果**: 在`.issues/`目录下创建solution.md
- **验收标准**: ✅ 文件路径正确 ✅ 文件包含解决方案模板

**验收点 AC-5.1.4**: AGENTS.md使用XML注释标记符
- **测试方法**: 执行open命令，检查AGENTS.md中的标记符格式
- **预期结果**: 使用`<!-- ISSUE-MAKE:START -->`和`<!-- ISSUE-MAKE:END -->`
- **验收标准**: ✅ 标记符格式正确 ✅ 无多余箭头符号

#### 需求5.2: AGENTS.md清理
**验收点 AC-5.2.1**: close时正确清理内容
- **测试方法**: 执行close命令，检查AGENTS.md
- **预期结果**: 移除对应issue的任务描述
- **验收标准**: ✅ 内容清理 ✅ 其他内容保留

**验收点 AC-5.2.2**: 多次open/close兼容性
- **测试方法**: 重复执行open/close不同issue
- **预期结果**: 每次都正确更新和清理
- **验收标准**: ✅ 无残留内容 ✅ 无重复内容

### 6. 错误处理与边界情况

#### 需求6.1: 文件操作异常
**验收点 AC-6.1.1**: 文件权限不足处理
- **测试方法**: 在只读目录执行命令
- **预期结果**: 显示权限错误提示
- **验收标准**: ✅ 错误信息清晰 ✅ 不崩溃

**验收点 AC-6.1.2**: 磁盘空间不足处理
- **测试方法**: 模拟磁盘满的情况
- **预期结果**: 显示存储空间错误
- **验收标准**: ✅ 提示明确 ✅ 数据完整

#### 需求6.2: 网络异常处理
**验收点 AC-6.2.1**: AI服务不可用降级
- **测试方法**: 断网状态下创建issue
- **预期结果**: 使用默认标题，功能正常
- **验收标准**: ✅ 降级成功 ✅ 提示用户

**验收点 AC-6.2.2**: 网络超时处理
- **测试方法**: 模拟网络超时
- **预期结果**: 超时后自动降级
- **验收标准**: ✅ 超时时间合理 ✅ 用户体验良好

#### 需求6.3: 业务逻辑异常
**验收点 AC-6.3.1**: 重复open同一issue报错
- **测试方法**: open一个issue后，再次open同一个issue
- **预期结果**: 显示错误提示，指出该issue已在处理中
- **验收标准**: ✅ 错误信息清晰 ✅ 不重复创建doing文件

**验收点 AC-6.3.2**: close时缺少solution.md报错
- **测试方法**: open issue后，删除solution.md，然后执行close
- **预期结果**: 显示错误提示，指出solution.md不存在
- **验收标准**: ✅ 错误信息清晰 ✅ 指导用户让agent创建

## 🧪 验收测试清单

### 必须通过的验收点 (P0)
- [ ] AC-1.1.1: 配置文件创建
- [ ] AC-2.1.1: TUI启动
- [ ] AC-2.2.1: Slash命令解析
- [ ] AC-2.2.3: slash命令文件存储在stash目录
- [ ] AC-3.1.1: CLI add命令
- [ ] AC-3.2.1: open by number
- [ ] AC-4.1.1: 目录创建
- [ ] AC-4.2.1: ID自增
- [ ] AC-4.3.3: issue文件日期格式正确
- [ ] AC-5.1.1: AGENTS.md更新
- [ ] AC-5.1.3: open时创建solution.md文件
- [ ] AC-5.1.4: AGENTS.md使用XML注释标记符
- [ ] AC-6.3.1: 重复open同一issue报错
- [ ] AC-6.3.2: close时缺少solution.md报错

### 重要验收点 (P1)
- [ ] AC-1.2.1: AI配置验证
- [ ] AC-2.3.1: AI标题生成
- [ ] AC-3.2.2: open by title
- [ ] AC-3.3.1: close流程
- [ ] AC-4.3.1: 文件命名规范
- [ ] AC-5.1.2: AGENTS.md不存在时自动创建
- [ ] AC-5.2.1: AGENTS.md清理

### 期望验收点 (P2)
- [ ] AC-1.2.2: 配置错误提示
- [ ] AC-2.2.2: 命令错误提示
- [ ] AC-2.3.2: AI降级处理
- [ ] AC-4.2.2: 删除后ID管理
- [ ] AC-6.1.1: 权限异常处理
- [ ] AC-6.2.1: 网络异常降级

### 可选验收点 (P3)
- [ ] AC-2.1.2: TUI界面优化
- [ ] AC-6.1.2: 磁盘空间处理
- [ ] AC-6.2.2: 网络超时处理

## 📊 验收通过标准

### MVP验收标准
- 所有P0级别验收点通过
- 核心功能流程可正常演示
- 无阻塞性bug

### 完整版验收标准
- 所有P0、P1级别验收点通过
- 80%以上P2级别验收点通过
- 性能满足基本要求
- 文档完整
- 文档完整

### 生产就绪标准
- 所有验收点通过
- 性能和稳定性达标
- 安全性验证通过
- 用户手册完整

## 🔍 验收测试环境

### 系统要求
- Node.js >= 16.0.0
- 支持的操作系统: Windows 10+, macOS 10.15+, Ubuntu 20.04+
- 终端环境: 支持ANSI转义序列

### 测试数据准备
- 有效AI服务商配置 (Deepseek示例)
- 各类型描述文件样本
- 边界情况测试数据
- 性能测试数据集

### 验收流程
1. 环境准备和配置
2. 按优先级逐项验证
3. 记录问题和改进建议
4. 生成验收报告
5. 确认发布状态

---

**验收负责人**: __________________ 
**验收日期**: __________________
**验收结果**: __________________